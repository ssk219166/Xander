<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Cart | Xander</title>
<script type="module" src="firebase-config.js"></script>
<style>
body{font-family:'Poppins',sans-serif; background:#f5f5f5; margin:0; padding:0;}
header{display:flex; justify-content:space-between; align-items:center; padding:15px 40px; background:#0072ff; color:#fff;}
header a{color:#fff; margin:0 10px; text-decoration:none;}
.cart-item{display:flex; justify-content:space-between; align-items:center; background:#fff; margin:10px; padding:10px; border-radius:8px; box-shadow:0 2px 5px rgba(0,0,0,0.2);}
.cart-item button{padding:5px 10px; margin-left:5px; cursor:pointer; border:none; border-radius:5px;}
.proceed{display:block; width:90%; margin:20px auto; padding:12px; border:none; background:#0072ff; color:#fff; font-weight:bold; cursor:pointer; border-radius:10px;}
</style>
</head>
<body>
<header>
<h1>Xander Cart</h1>
<nav>
  <a href="index.html">Home</a>
  <a href="shop.html">Shop</a>
  <a href="profile.html">Profile</a>
</nav>
<div id="cart-count">ðŸ›’ 0</div>
</header>

<main id="cartContainer"></main>
<button class="proceed" onclick="proceedCheckout()">Proceed to Checkout</button>

<script type="module">
import { auth } from './firebase-config.js';
import { onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";

function loadCart(){
  const cart = JSON.parse(localStorage.getItem('cart')||'[]');
  const container = document.getElementById('cartContainer');
  container.innerHTML='';
  if(!cart.length){ container.innerHTML='<p>Your cart is empty.</p>'; return; }
  cart.forEach((item,i)=>{
    const div=document.createElement('div');
    div.className='cart-item';
    div.innerHTML=`${item.name} (x${item.quantity}) - $${item.price} <div><button onclick="updateQty(${i})">Update</button><button onclick="removeItem(${i})">Remove</button></div>`;
    container.appendChild(div);
  });
  document.getElementById('cart-count').textContent=`ðŸ›’ ${cart.length}`;
}
window.removeItem=function(i){
  let cart = JSON.parse(localStorage.getItem('cart')||'[]');
  cart.splice(i,1);
  localStorage.setItem('cart',JSON.stringify(cart));
  loadCart();
}
window.updateQty=function(i){
  let cart = JSON.parse(localStorage.getItem('cart')||'[]');
  const qty=parseInt(prompt('Enter new quantity:',cart[i].quantity));
  if(qty>0){ cart[i].quantity=qty; localStorage.setItem('cart',JSON.stringify(cart)); loadCart(); }
}
window.proceedCheckout=function(){
  if(!JSON.parse(localStorage.getItem('cart')||'[]').length){ alert('Cart is empty!'); return; }
  window.location.href='gateway.html';
}
loadCart();
</script>
</body>
</html>
